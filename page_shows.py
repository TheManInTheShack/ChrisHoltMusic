# ==================================================================================================
# shows page
# ==================================================================================================

# ==================================================================================================
# Imports
# ==================================================================================================
import dash_core_components as dcc
import dash_html_components as html
from dash.dependencies import Input, Output

import pandas as pd
import plotly.express as px

from app import app

from lib import *

# ==================================================================================================
# Init
# ==================================================================================================
print("...loading shows page...")

def layout_shows(init_dict):
    # ==============================================================================================
    # Grab the information from the init
    # ==============================================================================================
    style_default      = init_dict['style_default']    
    data               = init_dict['data']                         
    pages              = init_dict['pages']
    footnote           = init_dict['footnote']
    title              = init_dict['title']

    # ==============================================================================================
    # Sort out the data
    # ==============================================================================================
    data_shows = get_data_shows(data)

    data_songs_by_show = data_shows.sort_values(by='Series Index')

    # ==============================================================================================
    # Page Contents Configuration
    # ==============================================================================================
    # ------------------------------------------------------------------------------
    # Chart information
    # ------------------------------------------------------------------------------
    charts={}
    charts['songs_by_show'] = {'chart_type':'bar', 
                                       'idx':'chart_songs_by_show', 
                                       'details':{'data':data_songs_by_show,
                                                     'x':'Show Title',
                                                     'y':['Count'], 
                                                 'style':style_default}}

    # ------------------------------------------------------------------------------
    # Control information
    # ------------------------------------------------------------------------------
    controls={}

    # ------------------------------------------------------------------------------
    # General layout information
    # ------------------------------------------------------------------------------
    layout={}
    layout['chart_shape']     = "1x1"
    layout['style_default']   = style_default
    layout['controls_orient'] = "top"

    # ==============================================================================================
    # Component layout
    # ==============================================================================================
    # ------------------------------------------------------------------------------
    # Compile components
    # ------------------------------------------------------------------------------
    components = []
    components.append(get_navbar(pages, title))
    components.extend(display_data_table(data_shows, idx="shows_data_table", title="Data by Show"))
    components.append(charts_with_controls(charts, controls, layout))
    components.append(get_footnote(footnote))

    # ------------------------------------------------------------------------------
    # Top Level
    # ------------------------------------------------------------------------------
    layout_shows = html.Div(components, style=style_default)
    return layout_shows

    # ==============================================================================================
    # Callbacks
    # ==============================================================================================

